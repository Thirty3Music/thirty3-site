<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>THIRTY3 — Work</title>
  <link rel="stylesheet" href="style.css"/>

  <style>
    :root{
      --muted:#b9c0c2;
      --chip:rgba(255,255,255,.06);
      --chipHover:rgba(255,255,255,.12);
      --line:rgba(255,255,255,.12);
      --bgGlass:rgba(0,0,0,.25);
      --accent:#57e2d6; /* title color */
      --ink:#e7eceb;
    }
    body.work{ overflow-y:auto; background:#000; padding-top:56px; }

    /* Hero */
    .wk-hero{ max-width:1100px; margin:48px auto 18px; padding:0 20px; }
    .wk-eyebrow{ color:var(--muted); letter-spacing:.18em; font-size:12px; margin:0 0 8px; text-transform:uppercase; opacity:.8; }
    .wk-title{ font-size:clamp(28px,3.5vw,42px); margin:0 0 10px; letter-spacing:.04em; color:var(--accent); }
    .wk-sub{ color:#dfe4e6; opacity:.85; margin:0 0 22px; line-height:1.5; }

    /* Tabs */
    .wk-tabs{
      display:flex; gap:10px; flex-wrap:wrap;
      border-top:1px solid var(--line); border-bottom:1px solid var(--line);
      padding:10px 0; margin-bottom:22px;
      background:repeating-linear-gradient(to bottom, rgba(255,255,255,.06) 0, rgba(255,255,255,.06) 1px, transparent 1px, transparent 42px);
      background-blend-mode:overlay;
    }
    .wk-tab{
      appearance:none; border:1px solid var(--line); background:var(--chip);
      color:#fff; font-size:13px; letter-spacing:.06em; font-weight:600;
      padding:8px 12px; border-radius:4px; cursor:pointer;
      transition:transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .wk-tab[aria-pressed="true"]{ background:var(--chipHover); border-color:#fff; }
    .wk-tab:hover{ transform:translateY(-1px); }

    /* Grid */
    .wk-grid{ max-width:1100px; margin:0 auto 64px; padding:0 20px; display:grid; grid-template-columns:repeat(3, 1fr); gap:16px; }
    @media (max-width:980px){ .wk-grid{ grid-template-columns:repeat(2, 1fr); } }
    @media (max-width:640px){ .wk-grid{ grid-template-columns:1fr; } }

    .wk-card{
      display:flex; flex-direction:column; gap:10px;
      background:var(--bgGlass); border:1px solid var(--line);
      border-radius:12px; overflow:hidden; cursor:pointer;
      transition:transform .14s ease, border-color .14s ease, box-shadow .14s ease;
      backdrop-filter: blur(4px);
    }
    .wk-card:hover{ transform:translateY(-2px); border-color:rgba(255,255,255,.28); box-shadow:0 10px 28px rgba(0,0,0,.35); }

    .wk-thumb{ aspect-ratio:16/10; object-fit:cover; width:100%; display:block; filter:contrast(.98) saturate(.95) brightness(.9); }
    .wk-meta{ display:flex; justify-content:space-between; align-items:center; padding:12px 14px; }
    .wk-kind{ font-size:11px; color:var(--muted); letter-spacing:.16em; text-transform:uppercase; }
    .wk-name{ font-size:15px; letter-spacing:.02em; color:var(--ink); } /* keep light */

    .wk-actions{ display:flex; gap:8px; padding:0 14px 14px; }
    .wk-chip{ border:1px solid var(--line); background:var(--chip); color:#fff; font-size:12px; padding:6px 8px; border-radius:6px; text-decoration:none; transition:background .12s ease, border-color .12s ease; }
    .wk-chip:hover{ background:var(--chipHover); border-color:#fff; }

    /* Modal */
    .wk-modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:10000; }
    .wk-modal[open]{ display:flex; }
    .wk-scrim{ position:absolute; inset:0; background:rgba(0,0,0,.55); }
    .wk-dialog{
      position:relative; z-index:1; width:min(1000px, 92vw); max-height:86vh;
      background:rgba(8,10,11,.85); border:1px solid var(--line);
      border-radius:14px; overflow:hidden; box-shadow:0 24px 60px rgba(0,0,0,.5);
      display:grid; grid-template-columns:1.1fr 1fr;
    }
    @media (max-width:900px){ .wk-dialog{ grid-template-columns:1fr; } }
    .wk-preview{ background:#0b0f11; display:grid; place-items:center; min-height:280px; }
    .wk-preview img, .wk-preview video, .wk-preview iframe{ width:100%; height:100%; object-fit:cover; border:0; }
    .wk-detail{ padding:18px 18px 20px; display:flex; flex-direction:column; gap:10px; }
    .wk-detail h3{ margin:2px 0 2px; letter-spacing:.02em; color:var(--ink); }
    .wk-detail p{ margin:0; color:#dfe4e6; opacity:.86; line-height:1.5; }
    .wk-detail .wk-row{ display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }

    .wk-tracks{ display:flex; flex-direction:column; gap:10px; margin-top:4px; }
    .wk-tracks .item{ border:1px solid var(--line); border-radius:10px; overflow:hidden; background:rgba(255,255,255,.03); }
    .wk-tracks .item iframe{ width:100%; height:168px; display:block; }

    .wk-close{ position:absolute; top:10px; right:10px; border:1px solid var(--line); background:var(--chip); color:#fff; border-radius:8px; padding:6px 9px; cursor:pointer; font-size:13px; }
    .wk-close:hover{ background:var(--chipHover); border-color:#fff; }
  </style>
</head>

<body class="work">
  <header class="topbar">
    <nav>
      <a href="https://www.instagram.com/_thirty3_/" target="_blank">INSTAGRAM</a>
      <a href="https://soundcloud.com/thirty_3" target="_blank">SOUNDCLOUD</a>
      <a href="https://www.youtube.com/@thirty3473" target="_blank">YOUTUBE</a>
      <a href="work-test.html">WORK</a>
      <a href="index.html#contact">CONTACT</a>
    </nav>
  </header>

  <section class="wk-hero">
    <p class="wk-eyebrow">SELECTED</p>
    <h1 class="wk-title">Work</h1>
    <p class="wk-sub">Solo pieces, collaborations and live/visual projects.</p>

    <div class="wk-tabs" role="tablist" aria-label="Work categories">
      <button class="wk-tab" aria-pressed="true" data-filter="all">All</button>
      <button class="wk-tab" aria-pressed="false" data-filter="solo">Solo Projects</button>
      <button class="wk-tab" aria-pressed="false" data-filter="remix">Remixes</button>
      <button class="wk-tab" aria-pressed="false" data-filter="collab">Collabs</button>
      <button class="wk-tab" aria-pressed="false" data-filter="live">Live / AV</button>
    </div>
  </section>

  <section class="wk-grid" id="wkGrid" aria-live="polite"></section>

  <dialog class="wk-modal" id="wkModal">
    <div class="wk-scrim" data-close></div>
    <div class="wk-dialog">
      <div class="wk-preview" id="wkPreview"></div>
      <div class="wk-detail">
        <button class="wk-close" data-close>Close</button>
        <h3 id="wkTitle">Title</h3>
        <p id="wkDesc"></p>
        <div class="wk-row" id="wkLinks"></div>
        <div class="wk-tracks" id="wkTracks" hidden></div>
      </div>
    </div>
  </dialog>

  <script>
/* =========================================================
   THIRTY3 — Work grid
   ========================================================= */
const PLACEHOLDER = 'image00015.jpeg';

const scEmbed = (url) =>
  `https://w.soundcloud.com/player/?url=${encodeURIComponent(url)}&visual=true`;

/* ---------- PROJECTS (manuellt) ---------- */
let PROJECTS = [
  /* ====== ALBUM: Memories of Noise ====== */
  {
    title: "Memories of Noise (album)",
    kind: "solo",
    type: "album",
    thumb: "auto",
    media: { type: "embed", src: scEmbed("https://soundcloud.com/thirty_3/sets/memories-of-noise") },
    desc: "Nine tracks. Electronic/ambient/noise. Produced & mixed by THIRTY3.",
    links: [
      { label: "View set", href: "https://soundcloud.com/thirty_3/sets/memories-of-noise" }
    ],
    children: [
      { title: "Eternal EVA",  media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/eternal-eva")} },
      { title: "Astral Drift", media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/astral-drift")} },
      { title: "Chain Hole",   media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/chain-hole")}, links:[{label:"View on Bandcamp", href:"https://thirty3.bandcamp.com/track/chain-hole"}] },
      { title: "Blendfire",    media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/blendfire")} },
      { title: "Mislay (feat. Lidnesty)", media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/mislay-feat-lidnesty")}, links:[{label:"Watch MV", href:"https://youtu.be/tV5tmkoVEO0"}]},
      { title: "Digital Soul", media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/digital-soul")} },
      { title: "Lide",         media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/lide")} },
      { title: "Radiant Desire", media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/radiant-desire")} },
      { title: "Wanderer’s Odyssey", media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/wanderers-odyssey")}, links:[{label:"View set", href:"https://soundcloud.com/thirty_3/sets/memories-of-noise"}] },
    ]
  },

  /* ====== SOLO (singlar/EP) ====== */
  {
    title: "The Call Below",
    kind: "solo",
    thumb: "auto",
    media: { type: "embed", src: scEmbed("https://soundcloud.com/thirty_3/the-call-below") },
    desc: "Single released on Bandcamp.",
    links: [
      { label: "Watch MV", href: "https://youtu.be/Y_YEgEOXtAM" },
      { label: "View on Bandcamp", href: "https://thirty3.bandcamp.com/track/the-call-below" }
    ]
  },
  {
    title: "Esper",
    kind: "solo",
    thumb: "auto",
    media: { type: "embed", src: scEmbed("https://soundcloud.com/thirty_3/esper") },
    desc: "",
    links: [
      { label: "Listen (SoundCloud)", href: "https://soundcloud.com/thirty_3/esper" }
    ]
  },
  {
    title: "Two Souls",
    kind: "solo",
    thumb: "auto",
    media: { type: "embed", src: scEmbed("https://soundcloud.com/thirty_3/sets/two-souls") },
    desc: "Two-track single.",
    links: [
      { label: "View on Bandcamp", href: "https://thirty3.bandcamp.com/album/two-souls" }
    ]
  },

  /* ====== REMIXES ====== */
  { title:"southstar – Miss You (Thirty3 Remix)", kind:"remix", thumb:"auto",
    media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/southstar-miss-you-remix-1")},
    desc:"Darker DnB / breakbeat.",
    links:[{label:"Listen (SoundCloud)", href:"https://soundcloud.com/thirty_3/southstar-miss-you-remix-1"}]
  },
  { title:"COBRAH – BRAND NEW BITCH (Thirty3 Remix)", kind:"remix", thumb:"auto",
    media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/brand-new-bitch-thirty3-remix")},
    links:[{label:"Listen (SoundCloud)", href:"https://soundcloud.com/thirty_3/brand-new-bitch-thirty3-remix"}]
  },
  { title:"Bedroom – In My Head (Thirty3 Remix)", kind:"remix", thumb:"auto",
    media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/bedroom-in-my-head-thirty3-remix")},
    links:[{label:"Listen (SoundCloud)", href:"https://soundcloud.com/thirty_3/bedroom-in-my-head-thirty3-remix"}]
  },
  { title:"Yung Lean – Ghost Town (Thirty3 Remix)", kind:"remix", thumb:"auto",
    media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/yung-lean-ghost-town-feat-travis-scott-thirty3-remix")},
    links:[{label:"Listen (SoundCloud)", href:"https://soundcloud.com/thirty_3/yung-lean-ghost-town-feat-travis-scott-thirty3-remix"}]
  },
  { title:"Lykke Li – Possibility (Thirty3 Remix)", kind:"remix", thumb:"auto",
    media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/lykke-li-possibility-thirty3-remix")},
    links:[{label:"Listen (SoundCloud)", href:"https://soundcloud.com/thirty_3/lykke-li-possibility-thirty3-remix"}]
  },
  { title:"Escape (Thirty3 Remix)", kind:"remix", thumb:"auto",
    media:{type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/escape-thirty3-remix")},
    links:[{label:"Listen (SoundCloud)", href:"https://soundcloud.com/thirty_3/escape-thirty3-remix"}]
  },

  /* ====== COLLABS / LIVE ====== */
  {
    title: "Dream, girl — Cora Onori",
    kind: "collab",
    thumb: "auto",
    media: { type: "embed", src: "https://www.youtube.com/embed/A9clscLNVi0?start=8" },
    desc: "Produced by THIRTY3. Directed by Moncef Henaien.",
    links: [
      { label: "Watch (YouTube)", href: "https://www.youtube.com/watch?v=A9clscLNVi0" },
      { label: "Listen (SoundCloud)", href: "https://soundcloud.com/coraonori/dream-girl" }
    ]
  },
  {
    title: "11:59 — Short film",
    kind: "collab",
    thumb: "auto",
    media: { type: "embed", src: "https://player.vimeo.com/video/282178116" },
    desc: "Sound design & score. Field recordings (hometown + London).",
    links: [
      { label: "Project page", href: "https://petterscholander.com/project/1159" },
      { label: "Watch (Vimeo)", href: "https://vimeo.com/282178116" }
    ]
  },
  {
    title: "A short film about us and the environment",
    kind: "collab",
    thumb: "auto",
    media: { type: "embed", src: "https://player.vimeo.com/video/378989999" },
    desc: "Created by Petter Schölander. Music by Thirty3.",
    links: [ { label: "Watch (Vimeo)", href: "https://vimeo.com/378989999" } ]
  },
  {
    title: "N I T E F I S H — Live (Nordberg)",
    kind: "live",
    thumb: "auto",
    media: { type: "embed", src: "https://www.youtube.com/embed/GDiQughTDqI" },
    desc: "Live AV: performance, virtual environment + live-manipulated audio.",
    links: [ { label: "Watch (YouTube)", href: "https://www.youtube.com/watch?v=GDiQughTDqI" } ]
  },
  {
    title: "Barbie Slumlord — N I T E F I S H",
    kind: "collab",
    thumb: "auto",
    media: { type: "embed", src: "https://www.youtube.com/embed/o9cvorFHGos" },
    desc: "Produced · Mixed · Mastered by THIRTY3.",
    links: [ { label: "Watch (YouTube)", href: "https://www.youtube.com/watch?v=o9cvorFHGos" } ]
  },
  {
    title: "Mitsubishi Facelift — N I T E F I S H",
    kind: "collab",
    thumb: PLACEHOLDER,
    media: { type: "image", src: PLACEHOLDER },
    desc: "Produced · Mixed · Mastered by THIRTY3.",
    links: [
      { label: "Read (Kmag article)", href: "https://kmag.se/2024/06/09/n-i-t-e-f-i-s-h-slapper-singeln-mitsubishi-facelift-fran-kommande-ep/" }
    ]
  },
  {
    title: "Permaculture Heaven — N I T E F I S H (EP)",
    kind: "collab",
    thumb: "auto",
    media: { type:"embed", src: scEmbed("https://soundcloud.com/nitefishofficial/sets/permaculture-heaven-draft-part") },
    desc: "Production (several tracks) · Mix · Master.",
    links: [
      { label: "Listen (SoundCloud playlist)", href: "https://soundcloud.com/nitefishofficial/sets/permaculture-heaven-draft-part" }
    ]
  },
  {
    title: "Spider Plant — Mix (entire release)",
    kind: "collab",
    thumb: "auto",
    media: { type: "embed", src: "https://www.youtube.com/embed/7r2CZbvWSB8?list=OLAK5uy_nbkkukfRBX66iNm3pulXvNM5WEEPa6K38" },
    desc: "Mixing on all tracks.",
    links: [ { label: "Listen (YouTube)", href: "https://www.youtube.com/watch?v=7r2CZbvWSB8&list=OLAK5uy_nbkkukfRBX66iNm3pulXvNM5WEEPa6K38" } ]
  },
  {
    title: "Club Hub — Thirty3, N I T E F I S H",
    kind: "collab",
    thumb: "auto",
    media: { type:"embed", src: scEmbed("https://soundcloud.com/thirty_3/club-hub") },
    desc: "Collaboration single.",
    links: [
      { label: "Listen (SoundCloud)", href:"https://soundcloud.com/thirty_3/club-hub" },
      { label: "View on Bandcamp", href:"https://nitefishofficial.bandcamp.com/track/club-hub" }
    ]
  },
];

/* ---------- auto-preview/thumbnails ---------- */
function youtubeIdFrom(url){
  const m = url.match(/(?:embed\/|v=|youtu\.be\/)([A-Za-z0-9_-]{11})/);
  return m ? m[1] : null;
}

async function resolveThumb(p){
  if (p.thumb && p.thumb !== 'auto') return p.thumb;
  if (!p.media) return PLACEHOLDER;
  const url = p.media.src || '';

  if (/youtube\.com|youtu\.be/.test(url)) {
    const id = youtubeIdFrom(url);
    if (id) return `https://img.youtube.com/vi/${id}/hqdefault.jpg`;
  }
  if (/vimeo\.com/.test(url)) {
    try {
      const vimeoUrl = url.replace('https://player.vimeo.com/video/', 'https://vimeo.com/');
      const o = await fetch(`https://vimeo.com/api/oembed.json?url=${encodeURIComponent(vimeoUrl)}`).then(r=>r.json());
      if (o && o.thumbnail_url) return o.thumbnail_url;
    } catch(e){}
  }
  if (/soundcloud\.com/.test(url) || /w\.soundcloud\.com\/player/.test(url)) {
    try {
      let sc = url;
      const q = new URL(url).searchParams.get('url');
      if (q) sc = decodeURIComponent(q);
      const o = await fetch(`https://soundcloud.com/oembed?format=json&url=${encodeURIComponent(sc)}`).then(r=>r.json());
      if (o && o.thumbnail_url) return o.thumbnail_url.replace('-t500x500','-t300x300');
    } catch(e){}
  }
  return PLACEHOLDER;
}

/* ---------- render ---------- */
const grid  = document.getElementById('wkGrid');
const tabs  = [...document.querySelectorAll('.wk-tab')];
let current = 'all';

function createCard(p){
  const card = document.createElement('article');
  card.className = 'wk-card';
  card.setAttribute('tabindex','0');

  const img = document.createElement('img');
  img.className = 'wk-thumb';
  img.alt = p.title;
  img.src = PLACEHOLDER;
  resolveThumb(p).then(u => { img.src = u || PLACEHOLDER; }).catch(()=>{});

  const meta = document.createElement('div'); 
  meta.className = 'wk-meta';
  const left = document.createElement('div');
  const kind = document.createElement('div'); kind.className = 'wk-kind'; kind.textContent = (p.kind || 'solo');
  const name = document.createElement('div'); name.className = 'wk-name'; name.textContent = p.title;
  left.append(kind, name);
  meta.append(left);

  const actions = document.createElement('div'); 
  actions.className = 'wk-actions';
  (p.links||[]).forEach(l=>{
    const a = document.createElement('a');
    a.href = l.href; a.target = '_blank'; a.rel='noopener';
    a.className = 'wk-chip'; a.textContent = l.label;
    actions.appendChild(a);
  });

  card.append(img, meta, actions);
  card.addEventListener('click', ()=> openModal(p));
  card.addEventListener('keydown', (e)=>{ if(e.key==='Enter') openModal(p); });

  return card;
}

function passesFilter(p){
  if (current === 'all') return true;
  if (current === 'solo') return (p.kind === 'solo' || p.kind === 'remix'); // remixes ingår i Solo
  return p.kind === current;
}

function render(){
  grid.innerHTML = '';
  PROJECTS.filter(passesFilter).forEach(p => grid.appendChild(createCard(p)));
}

tabs.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabs.forEach(b=>b.setAttribute('aria-pressed','false'));
    btn.setAttribute('aria-pressed','true');
    current = btn.dataset.filter;
    render();
  });
});

/* ---------- modal ---------- */
const modal   = document.getElementById('wkModal');
const preview = document.getElementById('wkPreview');
const titleEl = document.getElementById('wkTitle');
const descEl  = document.getElementById('wkDesc');
const linksEl = document.getElementById('wkLinks');
const tracksEl= document.getElementById('wkTracks');

function openModal(p){
  titleEl.textContent = p.title;
  descEl.textContent  = p.desc || '';
  linksEl.innerHTML   = '';
  (p.links||[]).forEach(l=>{
    const a = document.createElement('a');
    a.href = l.href; a.target = '_blank'; a.rel='noopener';
    a.className = 'wk-chip'; a.textContent = l.label;
    linksEl.appendChild(a);
  });

  // main preview
  preview.innerHTML = '';
  if(p.media?.type === 'video'){
    const v = document.createElement('video');
    v.src = p.media.src; v.controls = true; v.playsInline = true;
    preview.appendChild(v);
  } else if (p.media?.type === 'embed'){
    const iframe = document.createElement('iframe');
    iframe.src = p.media.src;
    iframe.allow = "autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media; web-share";
    iframe.referrerPolicy = "strict-origin-when-cross-origin";
    preview.appendChild(iframe);
  } else {
    const im = document.createElement('img');
    im.src = p.media?.src || PLACEHOLDER; im.alt = p.title;
    preview.appendChild(im);
  }

  // album tracks (if any)
  tracksEl.innerHTML = '';
  if (Array.isArray(p.children) && p.children.length){
    tracksEl.hidden = false;
    p.children.forEach((t)=>{
      const wrap = document.createElement('div');
      wrap.className = 'item';
      if (t.media?.type === 'embed'){
        const f = document.createElement('iframe');
        f.src = t.media.src;
        f.allow = "autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media; web-share";
        f.referrerPolicy = "strict-origin-when-cross-origin";
        wrap.appendChild(f);
      }
      tracksEl.appendChild(wrap);
    });
  } else {
    tracksEl.hidden = true;
  }

  modal.setAttribute('open','');
}
modal.addEventListener('click', (e)=>{ if(e.target.hasAttribute('data-close')) modal.removeAttribute('open'); });
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') modal.removeAttribute('open'); });

/* ---------- (optional) merge auto-data om du kör scripts/sync.js ---------- */
async function loadAutoProjects() {
  try {
    const res = await fetch('data/auto-projects.json?v=' + Date.now(), { cache: 'no-store' });
    if (!res.ok) throw new Error('No auto-projects.json');
    const auto = await res.json();

    const seen = new Set();
    function dedupe(list){
      const out = [];
      for (const p of list){
        const k = (p.title||'').trim().toLowerCase();
        if (!k || seen.has(k)) continue;
        seen.add(k); out.push(p);
      }
      return out;
    }
    PROJECTS = dedupe([ ...auto, ...PROJECTS ]);
  } catch {}
}

(async function boot(){
  await loadAutoProjects();
  render();
})();
  </script>
</body>
</html>
